# 层级图记忆架构构想

> **构思时间**: 约 2023 年
> **整理时间**: 2026-02-07
> **来源**: 手写笔记本

---

## 💡 核心灵感

传统记忆存储是**扁平的**，但人脑记忆是**层级的**。

---

## 📐 架构设计

```
┌─────────────────────────────────────────┐
│                大话题                    │
│  (e.g. "项目讨论", "学习Python")         │
└─────────────────┬───────────────────────┘
                  │ contains
                  ▼
┌─────────────────────────────────────────┐
│                小任务                    │
│  (e.g. "需求评审", "调试bug")            │
└─────────────────┬───────────────────────┘
                  │ has_fragment
                  ▼
┌─────────────────────────────────────────┐
│              记忆片段                    │
│  + 时间戳 (timestamp)                   │
│  + 内容 (content)                       │
│  + 情感标签 (emotion_tag)               │
└─────────────────────────────────────────┘
```

---

## 🔑 关键设计点

### 1. 层级结构
- **话题 (Topic)** → 最高层，代表一个主题领域
- **任务 (Task)** → 中间层，代表具体的子任务
- **片段 (Fragment)** → 最底层，具体的记忆内容

### 2. 时间戳定位
每个记忆片段都有时间戳，支持：
- 精确时间检索："2023-10-15 的讨论"
- 相对时间检索："昨天说的"、"上周提到的"

### 3. 图数据库管理
使用图数据库动态创建和管理关系：
- **从属关系**: 话题 → 任务 → 片段
- **关联关系**: 片段 ↔ 片段 (跨话题引用)
- **分支工作能及分享**: 支持记忆的分叉和合并

### 4. 时间感知
> "让系统有感知对于时间的能力"

不仅存储时间戳，还要理解时间语义：
- "很久以前" vs "刚才"
- "每周一" 等周期性模式

---

## 🆚 与扁平存储对比

| 维度 | 扁平存储 | 层级图存储 |
|------|----------|------------|
| 检索方式 | 关键词匹配 | 结构+语义+时间 |
| 上下文 | 丢失 | 完整保留 |
| 定位精度 | 低 | 高 |
| 压缩友好 | 困难 | 按任务压缩 |

---

## 🚀 实现建议

1. **短期**: 基于现有 NetworkX 扩展，添加节点类型
2. **长期**: 考虑迁移到 Neo4j/NebulaGraph

---

## 📎 原始笔记

![层级图记忆架构笔记](/docs/前构思灵感/assets/memory_graph_sketch.jpg)

> *注: 如需保存原始图片，请手动添加到 assets 文件夹*
