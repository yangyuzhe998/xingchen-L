version: '3.8'

services:
  # 星辰-V 主程序
  xingchen:
    build: .
    container_name: xingchen-v
    restart: unless-stopped
    volumes:
      # 挂载记忆数据库，确保重启后记忆不丢失
      - ./data/memory:/app/src/memory
      # 挂载 .env 文件
      - ./.env:/app/.env
    environment:
      - TZ=Asia/Shanghai
    depends_on:
      - napcat

  # NapCatQQ (OneBot V11 服务端)
  napcat:
    image: mlikiowa/napcat-docker:latest
    container_name: napcat
    restart: unless-stopped
    environment:
      - ACCOUNT=YOUR_QQ_NUMBER  # 替换为你的 QQ 号
      - WS_ENABLE=true
      - WS_PORT=3001
      - HTTP_ENABLE=false
    ports:
      - "3001:3001"     # 暴露 WebSocket 端口
      - "6099:6099"     # WebUI 端口 (如有)
    volumes:
      # 挂载 NapCat 配置和数据，确保登录状态不丢失
      - ./data/napcat/config:/app/napcat/config
      - ./data/napcat/qq:/app/.config/QQ
    mac_address: 02:42:ac:11:00:02 # 固定 MAC 地址以防风控
